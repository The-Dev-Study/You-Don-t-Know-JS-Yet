# 1.6 인터프리터 이해하기
JS가 인터프리터 언어인지 컴파일러 언어인지에 대한 논쟁은 아주 오랫동안 이어져왔다. 이에 대한 중론은 '스크립트 언어다'이지만 실상은 좀 더 복잡하다.

프로그래밍 언어 발전사에서 인터프리터와 스크립트 언어는 컴파일 언어에 비해 열악하다고 평가 받아왔다. 성능 최적화가 잘 안 된다는 인식과 더불어 일부 스크립트 언어에서 좀 더 성숙한 방식인 동적 타입 대신 정적 타입을 사용하는 등의 이유 때문이다.

컴파일을 거치면 보통 분산 시스템에서 언제든 배포할 수 있는 바이너리 파일이 생성된다. 그런데 JS는 소스 코드 자체를 배포하지, 바이너리 파일을 배포하는 게 아니기 때문에 많은 사람이 JS는 컴파일러 언어가 아니라 주장한다.

이런 잘못된 정보에 기반한 주장은 무시해야 한다. JS가 인터프리터 언어인지 컴파일 언어인지 명확히 이해하고 있어야 JS가 오류를 어떻게 처리하는지를 알 수 있기 때문이다.

스크립트 언어나 인터프리터 언어는 대게 위에서 아래로 한 줄씩 코드가 실행되는 방식으로 만들어진다. 그리고 보통 실행이 시작되기 전에 거치는 사전 단계가 없다.

한편 프로그램이 실행되기 전에 파싱이라 부르는 사전 단계를 거치는 언어도 있다.
파싱과 컴파일을 거치는 언어의 다섯 번째 줄에 유효하지 않은 명령이 있다면 파싱 단계에서 오류가 발견되므로 사전에 오류를 차단할 수 있다. 이렇게 실행 전에 오류가 포함된 코드 조각이 어디 있는지 알 수 있으면 구문 오류 혹은 정적 오류를 차단하기 좋다.

그렇다면 JS는 파싱을 거치는 언어이긴 한데, 그럼 컴파일 언어이기도 한 걸까?
답은 예에 가깝다. JS에서 파싱이 끝난 코드는 한 줄씩 처리되지 않고 컴파일러를 거쳐 최적화된 이진 코드로 변환된 후 실행된다.

그럼 이제 컴파일 단계에서 어떤 일이 일어나는지 자세히 알아보자. 컴파일 단계에서는 JS 가상 머신에 전달할 이진 바이트 코드가 생성된다. 혹자는 가상 머신의 역할이 전달받은 바이트 코드를 해석 하는 것이라고 이야기 한다. 그런데 이런 관점에서는 자바를 비롯한 JVM 기반 언어는 컴파일이 아닌 인터프리터 언어라고 해석할 수 밖에 없다. 그럼 자바 등의 언어가 컴파일 언어라는 보편적인 주장에 모순이 생긴다. 

* 가상머신은 바이트 코드를 해석하는 것이 아닌, 그냥 실행한다는 이야기다.

흥미로운 점은 JS 엔진은 파싱 이후 생성된 코드를 다양한 방법으로 실행 전에 그때그때 JIT(Just In Time) 처리 및 최적화한다는 점이다. 이런 JS 엔진 작동 방식으로 인해 관점에 따라 JS를 컴파일 언어 혹은 인터프리터 언어라고 할 수 있는거다.

결론을 내려보자.

1. 개발자의 손을 떠난 코드는 바벨이 트랜스파일한다. 이후 웹팩을 비롯한 번들러를 거쳐 번들링되고 그 결과가 JS 엔진에 전달된다.
2.  JS 엔진은 전달받은 코드를 파싱해 추상 구문 트리로 바꾼다.
3. 이어서 엔진은 추상 구문 트리를 이진 바이트 코드로 바꾼다. 이 과정에서 JIT 컴파일러가 작동하며 최적화한다.
4. JS 가상 머신이 프로그램을 실행한다.

필자는 JS가 컴파일 언어라고 생각한다.
정적 오류를 미리 발견할 수 있는 특징이 있기 때문이다.